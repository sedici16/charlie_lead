<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lead Processor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  {% include 'partials/header.html' %}

  <main class="max-w-2xl mx-auto mt-10 px-4">
    <div class="bg-white shadow-md rounded-xl p-6 sm:p-10">
      <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">ðŸ§  Lead Processor</h1>

      <form method="post" action="/process" class="space-y-6">

        <!-- Domains -->
        <div>
          <label for="domains" class="block font-semibold text-gray-700 mb-1">Enter one domain or Apollo ID per line:</label>
          <textarea name="domains" rows="6" placeholder="example.com&#10;67e2e92dfdee22000df33dfd"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm font-mono shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
        </div>

        <!-- Job Titles -->
        <div>
          <label for="job_titles" class="block font-semibold text-gray-700 mb-1">Job titles to filter (one per line):</label>
          <textarea name="job_titles" rows="8"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm font-mono shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400">{% if job_titles %}{{ job_titles | join('\n') }}{% endif %}</textarea>
        </div>

        <!-- Domain for Sale -->
        <div>
          <label for="domain_sale" class="block font-semibold text-gray-700 mb-1">Domain for Sale:</label>
          <select name="domain_sale" id="domain_sale" required
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400">
            <option value="" disabled selected>-- Select a domain --</option>
            {% for d in available_domains %}
              <option value="{{ d.domain }}">{{ d.domain }} â€” ${{ d.price }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Results Per Page -->
        <div>
          <label for="per_page" class="block font-semibold text-gray-700 mb-1">Max number of people per company (default 100):</label>
          <input type="number" name="per_page" min="1" max="200" value="100"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400">
        </div>

        <!-- Toggle for similar titles -->
        <div class="mt-4">
          <label class="inline-flex items-center">
            <input type="checkbox" name="include_similar_titles" value="true" class="form-checkbox">
            <span class="ml-2 text-gray-700">(Fuzzy Search)Include similar job titles (e.g. VP for "Director")</span>
          </label>
        </div>


        <!-- Submit Button -->
        <button type="submit"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md shadow">
          ðŸš€ Start Processing
        </button>
      </form>

      <!-- Result Message -->
      {% if result %}
        <div class="mt-8 p-4 rounded-md border border-green-400 bg-green-50 text-green-700 font-medium">
          {{ result }}
        </div>
      {% endif %}

      <!-- Log Output -->
      {% if logs %}
        <div class="mt-8">
          <strong class="block text-sm font-semibold text-gray-700 mb-2">Log:</strong>
          <ul class="bg-gray-50 border border-gray-300 rounded-md p-4 text-sm font-mono max-h-80 overflow-y-auto list-disc pl-6 space-y-1">
            {% for entry in logs %}
              <li>{{ entry }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>
  </main>
</body>
</html>
